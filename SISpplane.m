%Copyright (c) 2010, Majid Bani-Yaghoub
%All rights reserved
%This code generates the phase plane of the besic SIS model for different values of recovery rate alpha
%The SIS Epidemic Model with no birth and death:
%dS(t)/dt = -betaS(t)I(t) + alphaI(t),
%dI(t)/dt =   betaS(t)I(t)- alphaI(t),
%where alpha and beta are respectively recovery and infection rates;
%S(t) and I(t) respectively are the number of Susceptible and Infected host
%at time t

clear
N=3*10^6;
I0=10^6;
% Create textbox
annotation('textbox',...
    [0.245642857142857 0.188095238095238 0.368642857142857 0.0976190476190484],...
    'String',{'Disease–Free equilibrium','Endemic equilibrium'},...
    'FontSize',12,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1]);

% Create textbox
annotation('textbox',...
    [0.212071428571428 0.244285714285716 0.0365 0.0523809523809517],...
    'String',{'o'},...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1],...
    'Color',[0 0 1]);

% Create textbox
annotation('textbox',...
    [0.211714285714286 0.200000000000001 0.0365 0.0523809523809517],...
    'String',{'o'},...
    'FontSize',14,...
    'FontName','Arial',...
    'FitBoxToText','off',...
    'EdgeColor',[1 1 1],...
    'Color',[0.847058823529412 0.16078431372549 0]);


for i=1:25 % try values 5, 15 and 25
beta=.2*10^-6;
alpha=i*10^(-1)/3;
alphaV(i)=alpha;
t=0:.01:80;
I= (beta*N-alpha)*I0*exp(beta*N*t-alpha*t)./ ((beta*N-alpha)+beta*I0*(exp(beta*N*t-alpha*t)-1));
S= N-I;
fp=plot(S,I,'LineWidth',2);
hold on
plot(N,0,'bo','LineWidth',2)
plot(N-I0,I0,'g*','LineWidth',2)
text(N-I0+10^5,I0,'\leftarrow IC:(S(0),I(0))',...
     'HorizontalAlignment','left')
xlabel('Number of Susceptible Host, S(t)')
ylabel('Number of Infected Host, I(t)  ')
hold on
if N-alphaV(i)/beta >=0
plot(alphaV(i)/beta,N-alphaV(i)/beta,'ro','LineWidth',2)
hold off
end
%R0(i)=N*beta/alphaV(i);
 hl=legend(fp(1),['\alpha =  ',num2str(alphaV(i),'%10.2f'),...
     ',  p/N =  ',num2str(alphaV(i)/(N*beta),'%10.2f'),',  I(',num2str(t(end)),') =',num2str(floor(I(end)))]);
set(hl, 'Position',[0.58 0.79 0.09 0.049],...
    'fontsize',12)  
axis([0 N 0 N])
pause(.8)
end
   
   title('Impacts of recovery rates on dynamics of the SIS model','FontWeight','bold')